(function() {
  var Fllib, SourceCollector, async, fs, pick,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  fs = require('fs');

  async = require('async');

  pick = require('file-picker').pick;

  SourceCollector = require('./flutils').SourceCollector;

  Fllib = (function() {
    function Fllib(build) {
      this.createBuildCommand = __bind(this.createBuildCommand, this);
      this.addArg = __bind(this.addArg, this);
      this.addSourceDirectory = __bind(this.addSourceDirectory, this);
      this.addExternalLibraryDirectory = __bind(this.addExternalLibraryDirectory, this);
      this.addLibraryDirectory = __bind(this.addLibraryDirectory, this);
      this.setFilterFunction = __bind(this.setFilterFunction, this);
      this.collector = new SourceCollector(build);
      this.build = build;
    }

    Fllib.prototype.setFilterFunction = function(func) {
      return this.filterFunction = func;
    };

    Fllib.prototype.addLibraryDirectory = function(path) {
      return this.collector.addLibraryDirectory(path);
    };

    Fllib.prototype.addExternalLibraryDirectory = function(path) {
      return this.collector.addExternalLibraryDirectory(path);
    };

    Fllib.prototype.addSourceDirectory = function(path) {
      return this.collector.addSourceDirectory(path);
    };

    Fllib.prototype.addArg = function(arg) {
      return this.collector.addArg(arg);
    };

    Fllib.prototype.createBuildCommand = function(output, complete) {
      var bin;
      bin = 'compc';
      return this.build.getSDKVersion((function(_this) {
        return function(version) {
          var args, directory, library, _i, _j, _k, _len, _len1, _len2, _ref, _ref1, _ref2;
          if (process.platform.indexOf('win') === 0) {
            if (version > '4.6.0') {
              bin = 'compc.bat';
            } else {
              bin = 'compc.exe';
            }
          }
          args = [];
          args.push(_this.build.wrap(_this.build.getEnv('FLEX_HOME') + '/bin/' + bin));
          _ref = _this.collector.getLibraries();
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            library = _ref[_i];
            args.push('-library-path ' + _this.build.wrap(library));
          }
          _ref1 = _this.collector.getExternalLibraries();
          for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
            library = _ref1[_j];
            args.push('-external-library-path ' + _this.build.wrap(library));
          }
          _ref2 = _this.collector.getSourceDirectories();
          for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {
            directory = _ref2[_k];
            args.push('-source-path ' + _this.build.wrap(directory));
          }
          return _this.collector.getIncludeClasses(_this.filterFunction, function(classPaths) {
            args.push('-include-classes ' + classPaths.join(' '));
            return _this.collector.getManifest(function(namespaces) {
              var arg, component, components, manifestCount, manifestFile, manifestSource, namespace, _l, _len3, _len4, _m, _ref3;
              manifestCount = 0;
              for (namespace in namespaces) {
                components = namespaces[namespace];
                manifestSource = '<?xml version="1.0" encoding="utf-8"?>\n';
                manifestSource += '<componentPackage>\n';
                for (_l = 0, _len3 = components.length; _l < _len3; _l++) {
                  component = components[_l];
                  if (classPaths.indexOf(component.path) > -1) {
                    manifestSource += "<component id='" + component.name + "' class='" + component.path + "'/>\n";
                  }
                }
                manifestSource += '</componentPackage>';
                manifestFile = "manifest" + manifestCount + ".xml";
                fs.writeFileSync(manifestFile, manifestSource, {
                  encoding: 'utf8'
                });
                args.push("-namespace " + namespace + " " + manifestFile);
                args.push("-include-namespaces " + namespace);
                manifestCount++;
              }
              _ref3 = _this.collector.getArgs();
              for (_m = 0, _len4 = _ref3.length; _m < _len4; _m++) {
                arg = _ref3[_m];
                args.push(_this.build.applyEnv(arg));
              }
              args.push('-output ' + _this.build.wrap(_this.build.resolvePath(output)));
              if (complete != null) {
                return complete(args.join(' '));
              }
            });
          });
        };
      })(this));
    };

    return Fllib;

  })();

  module.exports = Fllib;

}).call(this);

//# sourceMappingURL=data:application/json;base64,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QUMsUUFBQSxFQUFTLE1BQVY7aUJBQS9DLENBVEEsQ0FBQTtBQUFBLGdCQVlBLElBQUksQ0FBQyxJQUFMLENBQVcsYUFBQSxHQUFZLFNBQVosR0FBdUIsR0FBdkIsR0FBeUIsWUFBcEMsQ0FaQSxDQUFBO0FBQUEsZ0JBYUEsSUFBSSxDQUFDLElBQUwsQ0FBVyxzQkFBQSxHQUFxQixTQUFoQyxDQWJBLENBQUE7QUFBQSxnQkFlQSxhQUFBLEVBZkEsQ0FGRDtBQUFBLGVBRkE7QUF3QkE7QUFBQSxtQkFBQSw4Q0FBQTtnQ0FBQTtBQUNDLGdCQUFBLElBQUksQ0FBQyxJQUFMLENBQVUsS0FBQyxDQUFBLEtBQUssQ0FBQyxRQUFQLENBQWdCLEdBQWhCLENBQVYsQ0FBQSxDQUREO0FBQUEsZUF4QkE7QUFBQSxjQTJCQSxJQUFJLENBQUMsSUFBTCxDQUFVLFVBQUEsR0FBYSxLQUFDLENBQUEsS0FBSyxDQUFDLElBQVAsQ0FBWSxLQUFDLENBQUEsS0FBSyxDQUFDLFdBQVAsQ0FBbUIsTUFBbkIsQ0FBWixDQUF2QixDQTNCQSxDQUFBO0FBNkJBLGNBQUEsSUFBNEIsZ0JBQTVCO3VCQUFBLFFBQUEsQ0FBUyxJQUFJLENBQUMsSUFBTCxDQUFVLEdBQVYsQ0FBVCxFQUFBO2VBL0JzQjtZQUFBLENBQXZCLEVBckI2QztVQUFBLENBQTlDLEVBMUJvQjtRQUFBLEVBQUE7TUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQXJCLEVBTm1CO0lBQUEsQ0ExQnBCLENBQUE7O2lCQUFBOztNQU5ELENBQUE7O0FBQUEsRUFzSEEsTUFBTSxDQUFDLE9BQVAsR0FBaUIsS0F0SGpCLENBQUE7QUFBQSIsImZpbGUiOiJmbGxpYi5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbImZzID0gcmVxdWlyZSgnZnMnKVxuYXN5bmMgPSByZXF1aXJlKCdhc3luYycpXG5waWNrID0gcmVxdWlyZSgnZmlsZS1waWNrZXInKS5waWNrXG57U291cmNlQ29sbGVjdG9yfSA9IHJlcXVpcmUoJy4vZmx1dGlscycpXG5cbmNsYXNzIEZsbGliXG5cdGNvbnN0cnVjdG9yOiAoYnVpbGQpIC0+XG5cdFx0QGNvbGxlY3RvciA9IG5ldyBTb3VyY2VDb2xsZWN0b3IoYnVpbGQpXG5cdFx0QGJ1aWxkID0gYnVpbGRcblxuXHQjPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cdCMgc2V0dGluZ1xuXHQjPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cdCMgQHBhcmFtIGZ1bmMgYGJvb2xlYW4gZnVuY3Rpb24oZmlsZSlgXG5cdHNldEZpbHRlckZ1bmN0aW9uOiAoZnVuYykgPT5cblx0XHRAZmlsdGVyRnVuY3Rpb24gPSBmdW5jXG5cblx0YWRkTGlicmFyeURpcmVjdG9yeTogKHBhdGgpID0+XG5cdFx0QGNvbGxlY3Rvci5hZGRMaWJyYXJ5RGlyZWN0b3J5KHBhdGgpXG5cblx0YWRkRXh0ZXJuYWxMaWJyYXJ5RGlyZWN0b3J5OiAocGF0aCkgPT5cblx0XHRAY29sbGVjdG9yLmFkZEV4dGVybmFsTGlicmFyeURpcmVjdG9yeShwYXRoKVxuXG5cdGFkZFNvdXJjZURpcmVjdG9yeTogKHBhdGgpID0+XG5cdFx0QGNvbGxlY3Rvci5hZGRTb3VyY2VEaXJlY3RvcnkocGF0aClcblxuXHRhZGRBcmc6IChhcmcpID0+XG5cdFx0QGNvbGxlY3Rvci5hZGRBcmcoYXJnKVxuXG5cdCM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblx0IyBwcm9jZXNzXG5cdCM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblx0Y3JlYXRlQnVpbGRDb21tYW5kOiAob3V0cHV0LCBjb21wbGV0ZSkgPT5cblx0XHQjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdCMgMCBnZXQgZXhlYyBmaWxlXG5cdFx0Iy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRiaW4gPSAnY29tcGMnXG5cblx0XHRAYnVpbGQuZ2V0U0RLVmVyc2lvbiAodmVyc2lvbikgPT5cblx0XHRcdGlmIHByb2Nlc3MucGxhdGZvcm0uaW5kZXhPZignd2luJykgaXMgMFxuXHRcdFx0XHRpZiB2ZXJzaW9uID4gJzQuNi4wJ1xuXHRcdFx0XHRcdGJpbiA9ICdjb21wYy5iYXQnXG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRiaW4gPSAnY29tcGMuZXhlJ1xuXG5cdFx0XHQjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdFx0IyAxIGNyZWF0ZSBwYXRoIGFyZ3Ncblx0XHRcdCMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0XHRhcmdzID0gW11cblxuXHRcdFx0YXJncy5wdXNoKEBidWlsZC53cmFwKEBidWlsZC5nZXRFbnYoJ0ZMRVhfSE9NRScpICsgJy9iaW4vJyArIGJpbikpXG5cblx0XHRcdGZvciBsaWJyYXJ5IGluIEBjb2xsZWN0b3IuZ2V0TGlicmFyaWVzKClcblx0XHRcdFx0YXJncy5wdXNoKCctbGlicmFyeS1wYXRoICcgKyBAYnVpbGQud3JhcChsaWJyYXJ5KSlcblxuXHRcdFx0Zm9yIGxpYnJhcnkgaW4gQGNvbGxlY3Rvci5nZXRFeHRlcm5hbExpYnJhcmllcygpXG5cdFx0XHRcdGFyZ3MucHVzaCgnLWV4dGVybmFsLWxpYnJhcnktcGF0aCAnICsgQGJ1aWxkLndyYXAobGlicmFyeSkpXG5cblx0XHRcdGZvciBkaXJlY3RvcnkgaW4gQGNvbGxlY3Rvci5nZXRTb3VyY2VEaXJlY3RvcmllcygpXG5cdFx0XHRcdGFyZ3MucHVzaCgnLXNvdXJjZS1wYXRoICcgKyBAYnVpbGQud3JhcChkaXJlY3RvcnkpKVxuXG5cdFx0XHQjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdFx0IyAyIGNyZWF0ZSBpbmNsdWRlIGNsYXNzZXMgYXJnc1xuXHRcdFx0Iy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRcdEBjb2xsZWN0b3IuZ2V0SW5jbHVkZUNsYXNzZXMgQGZpbHRlckZ1bmN0aW9uLCAoY2xhc3NQYXRocykgPT5cblx0XHRcdFx0YXJncy5wdXNoKCctaW5jbHVkZS1jbGFzc2VzICcgKyBjbGFzc1BhdGhzLmpvaW4oJyAnKSlcblxuXHRcdFx0XHQjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdFx0XHQjIDMgY3JlYXRlIG1hbmlmZXN0IGZpbGVzXG5cdFx0XHRcdCNcblx0XHRcdFx0IyBtYW5pZmVzdC54bWwgc3BlY1xuXHRcdFx0XHQjIC0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdFx0XHQjIC1uYW1lc3BhY2UgaHR0cDovL3NzZW4ubmFtZS9ucy9zc2VuIG1hbmlmZXN0LnhtbFxuXHRcdFx0XHQjIC1pbmNsdWRlLW5hbWVzcGFjZSBodHRwOi8vc3Nlbi5uYW1lL25zL3NzZW5cblx0XHRcdFx0I1xuXHRcdFx0XHQjIDxjb21wb25lbnRQYWNrYWdlPlxuXHRcdFx0XHQjIFx0PGNvbXBvbmVudCBpZD1cIlN0cmlwZVwiIGNsYXNzPVwic3Nlbi5jb21wb25lbnRzLmZpbGxzLlN0cmlwZVwiLz5cblx0XHRcdFx0IyA8L2NvbXBvbmVudFBhY2thZ2U+XG5cdFx0XHRcdCNcblx0XHRcdFx0IyBtYW5pZmVzdCBvYmplY3Rcblx0XHRcdFx0IyAtLS0tLS0tLS0tLS0tLS0tXG5cdFx0XHRcdCMgLSBuYW1lc3BhY2VbJ2h0dHA6Ly9zc2VuLm5hbWUvbnMvc3NlbiddWzBdID0gXG5cdFx0XHRcdCMgXHRcdFx0XHRcdFx0XHRcdFx0XHRuYW1lOidTdHJpcGUnXG5cdFx0XHRcdCMgXHRcdFx0XHRcdFx0XHRcdFx0XHRwYXRoOidzc2VuLmNvbXBvbmVudHMuZmlsbHMuU3RyaXBlJ1xuXHRcdFx0XHQjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdFx0XHRAY29sbGVjdG9yLmdldE1hbmlmZXN0IChuYW1lc3BhY2VzKSA9PlxuXHRcdFx0XHRcblx0XHRcdFx0XHRtYW5pZmVzdENvdW50ID0gMFxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGZvciBuYW1lc3BhY2UsIGNvbXBvbmVudHMgb2YgbmFtZXNwYWNlc1xuXHRcdFx0XHRcdFx0IyBjcmVhdGUgbWFuaWZlc3QgZmlsZSBzb3VyY2Vcblx0XHRcdFx0XHRcdG1hbmlmZXN0U291cmNlID0gJzw/eG1sIHZlcnNpb249XCIxLjBcIiBlbmNvZGluZz1cInV0Zi04XCI/Plxcbidcblx0XHRcdFx0XHRcdG1hbmlmZXN0U291cmNlICs9ICc8Y29tcG9uZW50UGFja2FnZT5cXG4nXG5cdFx0XHRcdFx0XHRmb3IgY29tcG9uZW50IGluIGNvbXBvbmVudHNcblx0XHRcdFx0XHRcdFx0aWYgY2xhc3NQYXRocy5pbmRleE9mKGNvbXBvbmVudC5wYXRoKSA+IC0xXG5cdFx0XHRcdFx0XHRcdFx0bWFuaWZlc3RTb3VyY2UgKz0gXCI8Y29tcG9uZW50IGlkPScje2NvbXBvbmVudC5uYW1lfScgY2xhc3M9JyN7Y29tcG9uZW50LnBhdGh9Jy8+XFxuXCIgXG5cdFx0XHRcdFx0XHRtYW5pZmVzdFNvdXJjZSArPSAnPC9jb21wb25lbnRQYWNrYWdlPidcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0IyB3cml0ZSBtYW5pZmVzdCBmaWxlXG5cdFx0XHRcdFx0XHRtYW5pZmVzdEZpbGUgPSBcIm1hbmlmZXN0I3ttYW5pZmVzdENvdW50fS54bWxcIlxuXHRcdFx0XHRcdFx0ZnMud3JpdGVGaWxlU3luYyhtYW5pZmVzdEZpbGUsIG1hbmlmZXN0U291cmNlLCB7ZW5jb2Rpbmc6J3V0ZjgnfSlcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0IyBhZGQgbWFuaWZlc3QgZmlsZSBpbmZvIHRvIGFyZ3MgXG5cdFx0XHRcdFx0XHRhcmdzLnB1c2goXCItbmFtZXNwYWNlICN7bmFtZXNwYWNlfSAje21hbmlmZXN0RmlsZX1cIilcblx0XHRcdFx0XHRcdGFyZ3MucHVzaChcIi1pbmNsdWRlLW5hbWVzcGFjZXMgI3tuYW1lc3BhY2V9XCIpXG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdG1hbmlmZXN0Q291bnQrK1xuXG5cdFx0XHRcdFx0Iy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRcdFx0XHQjIDQgYXJncywgb3V0cHV0XG5cdFx0XHRcdFx0Iy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRcdFx0XHRmb3IgYXJnIGluIEBjb2xsZWN0b3IuZ2V0QXJncygpXG5cdFx0XHRcdFx0XHRhcmdzLnB1c2goQGJ1aWxkLmFwcGx5RW52KGFyZykpXG5cdFxuXHRcdFx0XHRcdGFyZ3MucHVzaCgnLW91dHB1dCAnICsgQGJ1aWxkLndyYXAoQGJ1aWxkLnJlc29sdmVQYXRoKG91dHB1dCkpKVxuXG5cdFx0XHRcdFx0Y29tcGxldGUoYXJncy5qb2luKCcgJykpIGlmIGNvbXBsZXRlP1xuXG5tb2R1bGUuZXhwb3J0cyA9IEZsbGliIl19