(function() {
  var $fs, $path, Fldoc, SourceCollector, async, exec, pick,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  $fs = require('fs-extra');

  $path = require('path');

  async = require('async');

  pick = require('file-picker').pick;

  exec = require('done-exec');

  SourceCollector = require('./flutils').SourceCollector;

  Fldoc = (function() {
    function Fldoc(build) {
      this.build = build;
      this.create = __bind(this.create, this);
      this.createBuildCommand = __bind(this.createBuildCommand, this);
      this.addArg = __bind(this.addArg, this);
      this.addSourceDirectory = __bind(this.addSourceDirectory, this);
      this.setApacheFlexAsdoc = __bind(this.setApacheFlexAsdoc, this);
      this.setAdobeAsdoc = __bind(this.setAdobeAsdoc, this);
      this.setFilterFunction = __bind(this.setFilterFunction, this);
      this.collector = new SourceCollector(this.build);
    }

    Fldoc.externalAsdocs = [];

    Fldoc.externalFldocs = [];

    Fldoc.adobeAsdoc = 'http://help.adobe.com/ko_KR/FlashPlatform/reference/actionscript/3/';

    Fldoc.apacheFlexAsdoc = 'http://flex.apache.org/asdoc/';

    Fldoc.prototype.setFilterFunction = function(func) {
      return this.filterFunction = func;
    };

    Fldoc.prototype.setAdobeAsdoc = function(url) {
      return this.adobeAsdoc = url;
    };

    Fldoc.prototype.setApacheFlexAsdoc = function(url) {
      this.apacheFlexAsdoc = url({
        setExternalAsdoc: (function(_this) {
          return function(url) {
            return _this.externalAsdocs.push(url);
          };
        })(this),
        setExternalFldoc: (function(_this) {
          return function(url) {
            return _this.externalFldocs.push(url);
          };
        })(this),
        addLibraryDirectory: (function(_this) {
          return function(path) {};
        })(this)
      });
      return this.collector.addLibraryDirectory(path);
    };

    Fldoc.prototype.addSourceDirectory = function(path) {
      return this.collector.addSourceDirectory(path);
    };

    Fldoc.prototype.addArg = function(arg) {
      return this.collector.addArg(arg);
    };

    Fldoc.prototype.createBuildCommand = function(output, complete) {
      var bin;
      bin = 'asdoc';
      return this.build.getSDKVersion((function(_this) {
        return function(version) {
          var args, directory, library, _i, _j, _k, _len, _len1, _len2, _ref, _ref1, _ref2;
          if (process.platform.indexOf('win') === 0) {
            if (version > '4.6.0') {
              bin = 'asdoc.bat';
            } else {
              bin = 'asdoc.exe';
            }
          }
          args = [];
          args.push(_this.build.wrap(_this.build.getEnv('FLEX_HOME') + '/bin/' + bin));
          _ref = _this.collector.getLibraries();
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            library = _ref[_i];
            args.push('-library-path ' + _this.build.wrap(library));
          }
          _ref1 = _this.collector.getExternalLibraries();
          for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
            library = _ref1[_j];
            args.push('-library-path ' + _this.build.wrap(library));
          }
          _ref2 = _this.collector.getSourceDirectories();
          for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {
            directory = _ref2[_k];
            args.push('-source-path ' + _this.build.wrap(directory));
          }
          return _this.collector.getIncludeClasses(_this.filterFunction, function(classPaths) {
            var arg, _l, _len3, _ref3;
            args.push('-doc-classes ' + classPaths.join(' '));
            _ref3 = _this.collector.getArgs();
            for (_l = 0, _len3 = _ref3.length; _l < _len3; _l++) {
              arg = _ref3[_l];
              args.push(_this.build.applyEnv(arg));
            }
            args.push('-output ' + _this.build.wrap(_this.build.resolvePath(output)));
            args.push('-keep-xml=true');
            args.push('-skip-xsl=true');
            if (complete != null) {
              return complete(args.join(' '));
            }
          });
        };
      })(this));
    };

    Fldoc.prototype.create = function(outputDirectory, complete) {
      var cacheDirectory;
      cacheDirectory = $path.normalize('.asdoc_cache');
      if ($fs.existsSync(cacheDirectory)) {
        $fs.removeSync(cacheDirectory);
      }
      return this.createBuildCommand(cacheDirectory, function(command) {
        return exec(command).run(function(err) {
          return complete();
        });
      });
    };

    Fldoc.prototype.getAsdocIndex = function(url, complete) {};

    return Fldoc;

  })();

  module.exports = Fldoc;

}).call(this);

//# sourceMappingURL=data:application/json;base64,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QTtPQUhBO2FBS0EsSUFBQyxDQUFBLGtCQUFELENBQW9CLGNBQXBCLEVBQW9DLFNBQUMsT0FBRCxHQUFBO2VBQ25DLElBQUEsQ0FBSyxPQUFMLENBQWEsQ0FBQyxHQUFkLENBQWtCLFNBQUMsR0FBRCxHQUFBO2lCQUNqQixRQUFBLENBQUEsRUFEaUI7UUFBQSxDQUFsQixFQURtQztNQUFBLENBQXBDLEVBTk87SUFBQSxDQTFGUixDQUFBOztBQUFBLG9CQTBHQSxhQUFBLEdBQWUsU0FBQyxHQUFELEVBQU0sUUFBTixHQUFBLENBMUdmLENBQUE7O2lCQUFBOztNQVJELENBQUE7O0FBQUEsRUErSEEsTUFBTSxDQUFDLE9BQVAsR0FBaUIsS0EvSGpCLENBQUE7QUFBQSIsImZpbGUiOiJmbGRvYy5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIiRmcyA9IHJlcXVpcmUoJ2ZzLWV4dHJhJylcbiRwYXRoID0gcmVxdWlyZSgncGF0aCcpXG5hc3luYyA9IHJlcXVpcmUoJ2FzeW5jJylcbnBpY2sgPSByZXF1aXJlKCdmaWxlLXBpY2tlcicpLnBpY2tcbmV4ZWMgPSByZXF1aXJlKCdkb25lLWV4ZWMnKVxue1NvdXJjZUNvbGxlY3Rvcn0gPSByZXF1aXJlKCcuL2ZsdXRpbHMnKVxuXG5jbGFzcyBGbGRvY1xuXHRjb25zdHJ1Y3RvcjogKEBidWlsZCkgLT5cblx0ICAgIEBjb2xsZWN0b3IgPSBuZXcgU291cmNlQ29sbGVjdG9yKEBidWlsZClcblx0XHRAZXh0ZXJuYWxBc2RvY3MgPSBbXVxuXHRcdEBleHRlcm5hbEZsZG9jcyA9IFtdXG5cdFx0QGFkb2JlQXNkb2MgPSAnaHR0cDovL2hlbHAuYWRvYmUuY29tL2tvX0tSL0ZsYXNoUGxhdGZvcm0vcmVmZXJlbmNlL2FjdGlvbnNjcmlwdC8zLydcblx0XHRAYXBhY2hlRmxleEFzZG9jID0gJ2h0dHA6Ly9mbGV4LmFwYWNoZS5vcmcvYXNkb2MvJ1xuXHRcdFxuXHRcdCMgc291cmNlID4gZXh0ZXJuYWxGbGRvY3MgPiBleHRlcm5hbEFzZG9jcyA+IGFwYWNoZUZsZXhBc2RvYyA+IGFkb2JlQXNkb2Ncblx0XHRcblx0Iz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXHQjIHNldHRpbmdcblx0Iz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXHQjIEBwYXJhbSBmdW5jIGBib29sZWFuIGZ1bmN0aW9uKGZpbGUpYFxuXHRzZXRGaWx0ZXJGdW5jdGlvbjogKGZ1bmMpID0+XG5cdFx0QGZpbHRlckZ1bmN0aW9uID0gZnVuY1xuXHRcblx0IyBleHRlcm5hbCBkb2N1bWVudCBzZXR0aW5nXHRcblx0c2V0QWRvYmVBc2RvYzogKHVybCkgPT5cblx0XHRAYWRvYmVBc2RvYyA9IHVybFxuXHRcdFxuXHRzZXRBcGFjaGVGbGV4QXNkb2M6ICh1cmwpID0+XG5cdFx0QGFwYWNoZUZsZXhBc2RvYyA9IHVybFxuXHRcdFxuICAgIHNldEV4dGVybmFsQXNkb2M6ICh1cmwpID0+XG4gICAgICAgIEBleHRlcm5hbEFzZG9jcy5wdXNoKHVybClcbiAgICAgICAgXG4gICAgc2V0RXh0ZXJuYWxGbGRvYzogKHVybCkgPT5cbiAgICAgICAgQGV4dGVybmFsRmxkb2NzLnB1c2godXJsKVxuICAgIFxuICAgICMgbGlicmFyeSBzZXR0aW5nICAgIFxuICAgIGFkZExpYnJhcnlEaXJlY3Rvcnk6IChwYXRoKSA9PlxuXHRcdEBjb2xsZWN0b3IuYWRkTGlicmFyeURpcmVjdG9yeShwYXRoKVxuXG5cdGFkZFNvdXJjZURpcmVjdG9yeTogKHBhdGgpID0+XG5cdFx0QGNvbGxlY3Rvci5hZGRTb3VyY2VEaXJlY3RvcnkocGF0aClcblxuXHRhZGRBcmc6IChhcmcpID0+XG5cdFx0QGNvbGxlY3Rvci5hZGRBcmcoYXJnKVxuICAgICAgICBcblx0Iz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXHQjIHByb2Nlc3Ncblx0Iz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXHRjcmVhdGVCdWlsZENvbW1hbmQ6IChvdXRwdXQsIGNvbXBsZXRlKSA9PlxuXHRcdCMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0IyAwIGdldCBleGVjIGZpbGVcblx0XHQjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdGJpbiA9ICdhc2RvYydcblxuXHRcdEBidWlsZC5nZXRTREtWZXJzaW9uICh2ZXJzaW9uKSA9PlxuXHRcdFx0aWYgcHJvY2Vzcy5wbGF0Zm9ybS5pbmRleE9mKCd3aW4nKSBpcyAwXG5cdFx0XHRcdGlmIHZlcnNpb24gPiAnNC42LjAnXG5cdFx0XHRcdFx0YmluID0gJ2FzZG9jLmJhdCdcblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdGJpbiA9ICdhc2RvYy5leGUnXG5cdFx0XHRcdFx0XG5cdFx0XHQjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdFx0IyAxIGNyZWF0ZSBwYXRoIGFyZ3Ncblx0XHRcdCMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0XHRhcmdzID0gW11cblxuXHRcdFx0YXJncy5wdXNoKEBidWlsZC53cmFwKEBidWlsZC5nZXRFbnYoJ0ZMRVhfSE9NRScpICsgJy9iaW4vJyArIGJpbikpXG5cblx0XHRcdGZvciBsaWJyYXJ5IGluIEBjb2xsZWN0b3IuZ2V0TGlicmFyaWVzKClcblx0XHRcdFx0YXJncy5wdXNoKCctbGlicmFyeS1wYXRoICcgKyBAYnVpbGQud3JhcChsaWJyYXJ5KSlcblxuXHRcdFx0Zm9yIGxpYnJhcnkgaW4gQGNvbGxlY3Rvci5nZXRFeHRlcm5hbExpYnJhcmllcygpXG5cdFx0XHRcdGFyZ3MucHVzaCgnLWxpYnJhcnktcGF0aCAnICsgQGJ1aWxkLndyYXAobGlicmFyeSkpXG5cblx0XHRcdGZvciBkaXJlY3RvcnkgaW4gQGNvbGxlY3Rvci5nZXRTb3VyY2VEaXJlY3RvcmllcygpXG5cdFx0XHRcdGFyZ3MucHVzaCgnLXNvdXJjZS1wYXRoICcgKyBAYnVpbGQud3JhcChkaXJlY3RvcnkpKVxuXHRcdFx0XHRcblx0XHRcdCMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0XHQjIDIgY3JlYXRlIGluY2x1ZGUgY2xhc3NlcyBhcmdzXG5cdFx0XHQjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdFx0QGNvbGxlY3Rvci5nZXRJbmNsdWRlQ2xhc3NlcyBAZmlsdGVyRnVuY3Rpb24sIChjbGFzc1BhdGhzKSA9PlxuXHRcdFx0XHRhcmdzLnB1c2goJy1kb2MtY2xhc3NlcyAnICsgY2xhc3NQYXRocy5qb2luKCcgJykpXG5cblx0XHRcdFx0Iy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRcdFx0IyAzIGFyZ3MsIG91dHB1dFxuXHRcdFx0XHQjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdFx0XHRmb3IgYXJnIGluIEBjb2xsZWN0b3IuZ2V0QXJncygpXG5cdFx0XHRcdFx0YXJncy5wdXNoKEBidWlsZC5hcHBseUVudihhcmcpKVxuXG5cdFx0XHRcdGFyZ3MucHVzaCgnLW91dHB1dCAnICsgQGJ1aWxkLndyYXAoQGJ1aWxkLnJlc29sdmVQYXRoKG91dHB1dCkpKVxuXHRcdFx0XHRcblx0XHRcdFx0YXJncy5wdXNoKCcta2VlcC14bWw9dHJ1ZScpXG5cdFx0XHRcdGFyZ3MucHVzaCgnLXNraXAteHNsPXRydWUnKVxuXG5cdFx0XHRcdGNvbXBsZXRlKGFyZ3Muam9pbignICcpKSBpZiBjb21wbGV0ZT9cblx0XG5cdGNyZWF0ZTogKG91dHB1dERpcmVjdG9yeSwgY29tcGxldGUpID0+XG5cdFx0Y2FjaGVEaXJlY3RvcnkgPSAkcGF0aC5ub3JtYWxpemUoJy5hc2RvY19jYWNoZScpXG5cdFx0XG5cdFx0IyByZW1vdmUgY2FjaGUgZGlyZWN0b3J5IGlmIGV4aXN0c1xuXHRcdCRmcy5yZW1vdmVTeW5jKGNhY2hlRGlyZWN0b3J5KSBpZiAkZnMuZXhpc3RzU3luYyhjYWNoZURpcmVjdG9yeSlcblx0XHRcblx0XHRAY3JlYXRlQnVpbGRDb21tYW5kIGNhY2hlRGlyZWN0b3J5LCAoY29tbWFuZCkgLT5cblx0XHRcdGV4ZWMoY29tbWFuZCkucnVuIChlcnIpIC0+XG5cdFx0XHRcdGNvbXBsZXRlKClcbiAgICAgICAgXG4gICAgXG4gICAgIyBjb21wbGV0ZSA9IGBmdW5jdGlvbihlcnJvciwgZGljKWBcbiAgICAjIGRpY1tuYW1lLnNwYWNlLkNsYXNzXVx0W3Byb3BlcnR5XVx0XHQ9IGh0dHA6Ly9+L25hbWUvc3BhY2UvQ2xhc3MuaHRtbCNwcm9wZXJ0eVxuICAgICMgZGljW25hbWUuc3BhY2UuQ2xhc3NdXHRbbWV0aG9kKCldXHRcdD0gaHR0cDovL34vbmFtZS9zcGFjZS9DbGFzcy5odG1sI21ldGhvZCgpXG4gICAgIyBkaWNbbmFtZS5zcGFjZV1cdFx0W21ldGhvZCgpXVx0XHQ9IGh0dHA6Ly9+L25hbWUvc3BhY2UvI21ldGhvZCgpID8/P1xuICAgICMgZGljW25hbWUuc3BhY2UuQ2xhc3NdXHRbc3R5bGU6bmFtZV1cdD0gaHR0cDovL34vbmFtZS9zcGFjZS9DbGFzcy5odG1sI3N0eWxlOm5hbWVcblx0Z2V0QXNkb2NJbmRleDogKHVybCwgY29tcGxldGUpIC0+XG5cdFx0IyBodHRwOi8vaGVscC5hZG9iZS5jb20va29fS1IvRmxhc2hQbGF0Zm9ybS9yZWZlcmVuY2UvYWN0aW9uc2NyaXB0LzMvYWxsLWluZGV4LUEuaHRtbFxuXHRcdCMgaHR0cDovL2ZsZXguYXBhY2hlLm9yZy9hc2RvYy9hbGwtaW5kZXgtQi5odG1sXG5cdFx0XG5cdFx0XG5cdFx0XG5cdFx0IyBnZXQgYWxsLWluZGV4LUEgfiBaXG5cdFx0XHQjIHBhcnNlIGFuZCBmaW5kIGNsYXNzPVwiaWR4cm93XCJcblx0XHRcdFx0IyBkaWNbLi5dWy4uXSA9IHVybFxuXHRcdFx0XHRcdCMgY29tcGxldGUoZXJyb3IsIGRpYylcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRcbm1vZHVsZS5leHBvcnRzID0gRmxkb2MiXX0=